console.log("🟢 Qalam Surveys Background Script Loaded");chrome.runtime.onInstalled.addListener(async()=>{console.log("📦 Extension installed/updated");const e=await chrome.storage.local.get(["autoFillEnabled","ratingOption","commentText","randomizeRating","ratingMin","ratingMax","randomizeComment"]),t={};e.autoFillEnabled===void 0&&(t.autoFillEnabled=!1),e.ratingOption===void 0&&(t.ratingOption="first"),e.commentText===void 0&&(t.commentText="Good"),e.randomizeRating===void 0&&(t.randomizeRating=!1),e.ratingMin===void 0&&(t.ratingMin=1),e.ratingMax===void 0&&(t.ratingMax=5),e.randomizeComment===void 0&&(t.randomizeComment=!1),Object.keys(t).length>0&&(await chrome.storage.local.set(t),console.log("✅ Default settings initialized:",t))});chrome.runtime.onMessage.addListener((e,t,o)=>{if(console.log("📨 Message received:",e),e.type==="GET_STATUS")return chrome.storage.local.get(["autoFillEnabled","survey_queue"],a=>{o({autoFillEnabled:a.autoFillEnabled||!1,queueLength:(a.survey_queue||[]).length})}),!0;if(e.type==="TOGGLE_AUTOFILL")return chrome.storage.local.set({autoFillEnabled:e.enabled},()=>{console.log(`🔄 Auto-fill ${e.enabled?"enabled":"disabled"}`),o({success:!0})}),!0;if(e.type==="CLEAR_QUEUE")return chrome.storage.local.remove("survey_queue",()=>{console.log("🗑️ Survey queue cleared"),o({success:!0})}),!0});
